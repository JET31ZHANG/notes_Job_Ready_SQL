# 探索关系数据库和SQL

目标：
- 描述什么是关系数据库，它是如何工作的，以及它与数据库管理系统（DBMS）的区别；
- 定义数据库表、关系、列、属性、行、记录、元组和数据类型；
- 了解什么是ACID；
- 通过“键”了解实体完整性和唯一性；
- 了解数据库备份策略。
- 
## 保存数据

保存数据的几种选择：
- 将文件或字节直接写入文件；
- 将数据存储在关系数据库中；
- 将数据存储在非关系数据库中。

## 数据库

数据库是数据的结构化表示，可进行读取和写入，并通常与使用数据的任何应用程序分开存储。

### 使用数据库
### 数据与信息

### 结构化和非结构化

在结构化数据库中，开发人员可以限制存储在数据库中的数据类型，提高数据完整性并减少数据冗余。与在非结构化数据库中创建和访问数据相比，在结构化数据库中创建新数据和访问存储的数据相对较慢。结构化数据库最适用于包含可预测数据类型数据的数据集。
数据完整性：数据的可靠性和准确性。
数据集：一组相关信息的集合，由单独的元素组成，但可作为一个整体进行操作。

### 数据库和数据库管理系统

数据库管理系统 DMBS：一种管理数据库的软件系统。它执行命令，提供安全性，支持网络访问，并为DBA提供处理数据库文件的管理工具。

## 关系数据库概念

- 表（table）
- 关系（relation）
- 实体（Entity）

行又称记录或元组，表中的每一行是与同表中的其他行不同的对象。
列又称字段或属性。

## ACID 规则

ACID：
- 原子性
- 一致性
- 隔离性
- 持久性

关系数据库允许执行的操作：
- 读取现有数据
- 插入新数据
- 更新现有数据
- 删除现有数据
- 添加或更改模式（表和关系）

事务：代表单个逻辑工作单元的操作集合。

### ACID 属性

- 原子性：全有或全无，不会让事务的操作部分成功。
- 一致性：一个事务能够将数据库从一个有效状态移到另一个有效状态。
  - 一致的数据库还会对允许的数据类型和数据宽度施加限制。
  - 一致性还强制执行主键和外键的关系。
    - 主键是分配给表中每一行的唯一值。系统永远不会允许表中出现重复的主键，且它要求每个记录都有一个主键值（该列不能为空值）。
    - 外键是表的每一行中的一个值，用于与另一个表相关联。大多数 DBMS 系统默认要求外键的值一定与对应的主键值相互匹配，不允许出现一个外键值没有对应的主键值。
- 隔离性（并发控制）：如果一个事务的影响在它完成之前对其他事务不可见，则该事务就是隔离的。
  - 隔离级别：
    - 串行执行
    - 读取未提交的数据
- 持久性：事务一旦被提交（保存到数据库中），即使在灾难性故障的情况下，它也会保持不变。（在事务被写入持久性存储设备前，它不会完全提交）

### 数据库和日志文件

在大多数ACID数据库中，事务日志是已执行操作的历史记录。
日志文件与实际数据库数据在物理上是分离的。

## 实体完整性

实体完整性：保证表中的每条记录在该表内都是唯一的。
当数据添加到表中时，RDBMS 将检查以下两个属性以确保新记录是唯一的：
- 该表中现有记录的主键值与新记录的主键值都不相同
- 主键值不为空

唯一性的目的：
- 减少（但不一定消除）重复数据；
- 允许数据库轻松查找表中的特定记录。

### 确保唯一性

满足实体完整性要求的关系设计方法：在每个表中包含一个或多个字段，其唯一目的是识别每个单独的记录。某些情况下，可将现有字段用作主键。
- 自然键（natural key）
- 代理键（surrogate key）：唯一标识表中的每个对象
- 候选键（candidate key）：用于指代一个字段，该字段本质上是每条记录的唯一标识符，但它可能不会成为表的主键

### 查找记录

## 备份策略

## 小结
- 介绍了数据库和关系数据库的概念以及ACID和键的使用。（学习和使用结构化查询语言SQL的基础）
- 当直接应用于SQL时，包括：
  - 表/关系（学术）/实体（抽象）：关系数据库中逻辑上分组的数据。表定义有效的事实，包含关于一种类型事物的事实。
  - 行/记录/元组（学术）：表中的一个逻辑项，由一个或多个值或字段组成。
  - 列/字段/属性（学术）：指定需要在表中跟踪的事实，并限制事实数据的大小和类型。
- ACID：（可靠性）只有满足原子性、一致性、隔离性和持久性的数据库才能处理可能发生的所有错误和故障，同时保障数据的质量。
- 键：组织数据的核心部分，有助于满足记录的唯一性，并帮助快速访问记录。
- 任何企业都应制定适合其预算和风险承受能力的备份和恢复计划。